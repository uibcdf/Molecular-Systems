{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "93cf335d24e7484fa207cfb9ffd91bd0",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from simtk import unit\n",
    "from simtk import openmm as omm\n",
    "from simtk.openmm import app\n",
    "import molsysmt as msm\n",
    "from tqdm import tqdm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Alanine dipeptide in explicit solvent"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## With OpenMM from scratch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from molecular_systems import files\n",
    "pdbfile_path = files.alanine_dipeptide['octahedral_14.pdb']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style><table id=\"T_b3211_\" ><thead>    <tr>        <th class=\"col_heading level0 col0\" >form</th>        <th class=\"col_heading level0 col1\" >n_atoms</th>        <th class=\"col_heading level0 col2\" >n_groups</th>        <th class=\"col_heading level0 col3\" >n_components</th>        <th class=\"col_heading level0 col4\" >n_chains</th>        <th class=\"col_heading level0 col5\" >n_molecules</th>        <th class=\"col_heading level0 col6\" >n_entities</th>        <th class=\"col_heading level0 col7\" >n_waters</th>        <th class=\"col_heading level0 col8\" >n_peptides</th>        <th class=\"col_heading level0 col9\" >n_frames</th>    </tr></thead><tbody>\n",
       "                <tr>\n",
       "                                <td id=\"T_b3211_row0_col0\" class=\"data row0 col0\" >pdb</td>\n",
       "                        <td id=\"T_b3211_row0_col1\" class=\"data row0 col1\" >4333</td>\n",
       "                        <td id=\"T_b3211_row0_col2\" class=\"data row0 col2\" >1440</td>\n",
       "                        <td id=\"T_b3211_row0_col3\" class=\"data row0 col3\" >1438</td>\n",
       "                        <td id=\"T_b3211_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "                        <td id=\"T_b3211_row0_col5\" class=\"data row0 col5\" >1438</td>\n",
       "                        <td id=\"T_b3211_row0_col6\" class=\"data row0 col6\" >2</td>\n",
       "                        <td id=\"T_b3211_row0_col7\" class=\"data row0 col7\" >1437</td>\n",
       "                        <td id=\"T_b3211_row0_col8\" class=\"data row0 col8\" >1</td>\n",
       "                        <td id=\"T_b3211_row0_col9\" class=\"data row0 col9\" >1</td>\n",
       "            </tr>\n",
       "    </tbody></table>"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x7ff0d686dcd0>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "msm.info(pdbfile_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "4a3d8becc6bd40458f54d91c286d47d3",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "NGLWidget()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "view = msm.view(pdbfile_path, surface=True)\n",
    "view"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Before energy minimization: -17415.342173066165 kJ/mol\n",
      "After energy minimization: -70224.23182850215 kJ/mol\n"
     ]
    }
   ],
   "source": [
    "temperature = 300.0*unit.kelvin\n",
    "collisions_rate = 1.0/unit.picoseconds\n",
    "total_time = 50.0*unit.picoseconds\n",
    "saving_timestep = 1.0*unit.picoseconds\n",
    "integration_timestep = 2.0*unit.femtoseconds\n",
    "\n",
    "steps_per_cicle = round(saving_timestep/integration_timestep)\n",
    "n_steps = round(total_time/integration_timestep)\n",
    "n_cicles = round(n_steps/steps_per_cicle)\n",
    "\n",
    "pdbfile = app.PDBFile(pdbfile_path)\n",
    "\n",
    "topology = pdbfile.topology\n",
    "positions = pdbfile.positions\n",
    "\n",
    "forcefield = app.ForceField('amber14-all.xml', 'amber14/tip3p.xml')\n",
    "\n",
    "system = forcefield.createSystem(topology,\n",
    "                                 nonbondedMethod=app.PME, nonbondedCutoff=9.0*unit.angstroms,\n",
    "                                 switchDistance=7.5*unit.angstroms,\n",
    "                                 rigidWater=True, constraints=app.HBonds, hydrogenMass=None)\n",
    "\n",
    "forces = {ii.__class__.__name__ : ii for ii in system.getForces()}\n",
    "forces['NonbondedForce'].setUseDispersionCorrection(True)\n",
    "forces['NonbondedForce'].setEwaldErrorTolerance(1.0e-5)\n",
    "\n",
    "integrator = omm.LangevinIntegrator(temperature, collisions_rate, integration_timestep)\n",
    "integrator.setConstraintTolerance(0.00001)\n",
    "\n",
    "platform = omm.Platform.getPlatformByName('CUDA')\n",
    "simulation_properties = {}\n",
    "simulation_properties['CudaPrecision']='mixed'\n",
    "\n",
    "# Context.\n",
    "\n",
    "context = omm.Context(system, integrator, platform, simulation_properties)\n",
    "context.setPositions(positions)\n",
    "\n",
    "# Energy Minimization\n",
    "Potential_Energy = context.getState(getEnergy=True).getPotentialEnergy()\n",
    "print('Before energy minimization: {}'.format(Potential_Energy))\n",
    "omm.LocalEnergyMinimizer_minimize(context)\n",
    "Potential_Energy = context.getState(getEnergy=True).getPotentialEnergy()\n",
    "print('After energy minimization: {}'.format(Potential_Energy))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 49/49 [05:04<00:00,  6.21s/it]\n"
     ]
    }
   ],
   "source": [
    "# Initial velocities\n",
    "n_atoms = topology.getNumAtoms()\n",
    "velocities = np.zeros([n_atoms, 3], np.float32) * unit.nanometers/unit.picosecond\n",
    "context.setVelocities(velocities)\n",
    "\n",
    "# Reporter arrays: time, position, velocity, kinetic_energy, potential_energy\n",
    "\n",
    "time = np.zeros([n_cicles], np.float32) * unit.picoseconds\n",
    "trajectory = np.zeros([n_cicles, n_atoms, 3], np.float32) * unit.nanometers\n",
    "velocity = np.zeros([n_cicles, n_atoms, 3], np.float32) * unit.nanometers/unit.picosecond\n",
    "kinetic_energy = np.zeros([n_cicles], np.float32) * unit.kilocalories_per_mole\n",
    "potential_energy = np.zeros([n_cicles], np.float32) * unit.kilocalories_per_mole\n",
    "\n",
    "# Initial context in reporters\n",
    "\n",
    "state = context.getState(getPositions=True, getVelocities=True, getEnergy=True)\n",
    "time[0] = state.getTime()\n",
    "trajectory[0] = state.getPositions()\n",
    "velocity[0] = state.getVelocities()\n",
    "kinetic_energy[0] = state.getKineticEnergy()\n",
    "potential_energy[0] = state.getPotentialEnergy()\n",
    "\n",
    "# Integration loop saving every cicle steps\n",
    "\n",
    "for ii in tqdm(range(1, n_cicles)):\n",
    "    context.getIntegrator().step(steps_per_cicle)\n",
    "    state = context.getState(getPositions=True, getVelocities=True, getEnergy=True)\n",
    "    time[ii] = state.getTime()\n",
    "    trajectory[ii] = state.getPositions()\n",
    "    velocity[ii] = state.getVelocities()\n",
    "    kinetic_energy[ii] = state.getKineticEnergy()\n",
    "    potential_energy[ii] = state.getPotentialEnergy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50, 4333, 3)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trajectory.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The trajectory occupies 0.002421252429485321 gigabytes.\n"
     ]
    }
   ],
   "source": [
    "print('The trajectory occupies {} gigabytes.'.format(trajectory.nbytes / 1024**3))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(time, potential_energy)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "_, _, phi_values, psi_values = msm.ramachandran_angles([topology, trajectory])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(phi_values, psi_values)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## With MolSysMT "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## With this library"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "from molecular_systems import AlanineDipeptideExplicitSolvent\n",
    "from molecular_systems.tools.md import langevin_NVT, energy_minimization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Potential energy before minimization: -17415.52575900621 kJ/mol\n",
      "Potential energy after minimization: -70408.30700900621 kJ/mol\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 49/49 [04:02<00:00,  4.95s/it]\n"
     ]
    }
   ],
   "source": [
    "dialanine=AlanineDipeptideExplicitSolvent(forcefield='AMBER14')\n",
    "\n",
    "energy_minimization(dialanine)\n",
    "time, trajectory, velocity, kin_energy, pot_energy = langevin_NVT(dialanine,\n",
    "                                                                  temperature = 300 * unit.kelvin,\n",
    "                                                                  friction = 1.0 / unit.picoseconds,\n",
    "                                                                  saving_timestep = 1.0 * unit.picoseconds,\n",
    "                                                                  total_time = 50.0 * unit.picoseconds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "_, _, phi_values, psi_values = msm.ramachandran_angles([dialanine.topology, trajectory])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x7ff0d4dade50>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(phi_values, psi_values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "03bdadf0f50b4e0ab5035d3a85eede1e",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "NGLWidget(max_frame=49)"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "view = msm.view([dialanine.topology, trajectory], surface=False)\n",
    "view"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
